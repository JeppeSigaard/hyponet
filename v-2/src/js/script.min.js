function updateBrainData(e,n,t){if(n&&""!==n){var r=Object.keys(e).length+1;e[r]=n}if(t&&""!==t){var r=Object.keys(e).length+1;e[r]=t}}!function(e){e.extend({debounce:function(e,n,t,r){3==arguments.length&&"boolean"!=typeof t&&(r=t,t=!1);var o;return function(){var i=arguments;r=r||this,t&&!o&&e.apply(r,i),clearTimeout(o),o=setTimeout(function(){!t&&e.apply(r,i),o=null},n)}},throttle:function(e,n,t){var r,o,i;return function(){o=arguments,i=!0,t=t||this,r||!function(){i?(e.apply(t,o),i=!1,r=setTimeout(arguments.callee,n)):r=null}()}}})}(jQuery),function(e,n){function t(e,n,t){if(Array.prototype.map)return Array.prototype.map.call(e,n,t);for(var r=new Array(e.length),o=0,i=e.length;i>o;o++)r[o]=n.call(t,e[o],o,e);return r}function r(e){return{newPos:e.newPos,components:e.components.slice(0)}}function o(e){for(var n=[],t=0;t<e.length;t++)e[t]&&n.push(e[t]);return n}function i(e){var n=e;return n=n.replace(/&/g,"&amp;"),n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/"/g,"&quot;")}function a(e,n,t){n=n||[],t=t||[];var r;for(r=0;r<n.length;r+=1)if(n[r]===e)return t[r];var o;if("[object Array]"===l.call(e)){for(n.push(e),o=new Array(e.length),t.push(o),r=0;r<e.length;r+=1)o[r]=a(e[r],n,t);n.pop(),t.pop()}else if("object"==typeof e&&null!==e){n.push(e),o={},t.push(o);var i,u=[];for(i in e)u.push(i);for(u.sort(),r=0;r<u.length;r+=1)i=u[r],o[i]=a(e[i],n,t);n.pop(),t.pop()}else o=e;return o}function u(e,n,r,o){for(var i=0,a=e.length,u=0,s=0;a>i;i++){var l=e[i];if(l.removed){if(l.value=r.slice(s,s+l.count).join(""),s+=l.count,i&&e[i-1].added){var f=e[i-1];e[i-1]=e[i],e[i]=f}}else{if(!l.added&&o){var p=n.slice(u,u+l.count);p=t(p,function(e,n){var t=r[s+n];return t.length>e.length?t:e}),l.value=p.join("")}else l.value=n.slice(u,u+l.count).join("");u+=l.count,l.added||(s+=l.count)}}return e}function s(e){this.ignoreWhitespace=e}var l=Object.prototype.toString;s.prototype={diff:function(e,t,o){function i(e){return o?(setTimeout(function(){o(n,e)},0),!0):e}function a(){for(var o=-1*p;p>=o;o+=2){var a,d=c[o-1],h=c[o+1],v=(h?h.newPos:0)-o;d&&(c[o-1]=n);var g=d&&d.newPos+1<l,m=h&&v>=0&&f>v;if(g||m){if(!g||m&&d.newPos<h.newPos?(a=r(h),s.pushComponent(a.components,n,!0)):(a=d,a.newPos++,s.pushComponent(a.components,!0,n)),v=s.extractCommon(a,t,e,o),a.newPos+1>=l&&v+1>=f)return i(u(a.components,t,e,s.useLongestToken));c[o]=a}else c[o]=n}p++}var s=this;if(t===e)return i([{value:t}]);if(!t)return i([{value:e,removed:!0}]);if(!e)return i([{value:t,added:!0}]);t=this.tokenize(t),e=this.tokenize(e);var l=t.length,f=e.length,p=1,d=l+f,c=[{newPos:-1,components:[]}],h=this.extractCommon(c[0],t,e,0);if(c[0].newPos+1>=l&&h+1>=f)return i([{value:t.join("")}]);if(o)!function g(){setTimeout(function(){return p>d?o():void(a()||g())},0)}();else for(;d>=p;){var v=a();if(v)return v}},pushComponent:function(e,n,t){var r=e[e.length-1];r&&r.added===n&&r.removed===t?e[e.length-1]={count:r.count+1,added:n,removed:t}:e.push({count:1,added:n,removed:t})},extractCommon:function(e,n,t,r){for(var o=n.length,i=t.length,a=e.newPos,u=a-r,s=0;o>a+1&&i>u+1&&this.equals(n[a+1],t[u+1]);)a++,u++,s++;return s&&e.components.push({count:s}),e.newPos=a,u},equals:function(e,n){var t=/\S/;return e===n||this.ignoreWhitespace&&!t.test(e)&&!t.test(n)},tokenize:function(e){return e.split("")}};var f=new s,p=new s(!0),d=new s;p.tokenize=d.tokenize=function(e){return o(e.split(/(\s+|\b)/))};var c=new s(!0);c.tokenize=function(e){return o(e.split(/([{}:;,]|\s+)/))};var h=new s,v=new s;v.ignoreTrim=!0,h.tokenize=v.tokenize=function(e){for(var n=[],t=e.split(/^/m),r=0;r<t.length;r++){var o=t[r],i=t[r-1],a=i&&i[i.length-1];"\n"===o&&"\r"===a?n[n.length-1]=n[n.length-1].slice(0,-1)+"\r\n":(this.ignoreTrim&&(o=o.trim(),r<t.length-1&&(o+="\n")),n.push(o))}return n};var g=new s;g.tokenize=function(e){var n=[],t=e.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var r=0;r<t.length;r++){var o=t[r];r%2?n[n.length-1]+=o:n.push(o)}return n};var m=new s;m.tokenize=function(e){return o(e.split(/(\S.+?[.!?])(?=\s+|$)/))};var y=new s;y.useLongestToken=!0,y.tokenize=h.tokenize,y.equals=function(e,n){return h.equals(e.replace(/,([\r\n])/g,"$1"),n.replace(/,([\r\n])/g,"$1"))};var b={Diff:s,diffChars:function(e,n,t){return f.diff(e,n,t)},diffWords:function(e,n,t){return p.diff(e,n,t)},diffWordsWithSpace:function(e,n,t){return d.diff(e,n,t)},diffLines:function(e,n,t){return h.diff(e,n,t)},diffTrimmedLines:function(e,n,t){return v.diff(e,n,t)},diffSentences:function(e,n,t){return m.diff(e,n,t)},diffCss:function(e,n,t){return c.diff(e,n,t)},diffJson:function(e,t,r){return y.diff("string"==typeof e?e:JSON.stringify(a(e),n,"  "),"string"==typeof t?t:JSON.stringify(a(t),n,"  "),r)},createTwoFilesPatch:function(e,n,r,o,i,a){function u(e){return t(e,function(e){return" "+e})}function s(e,n,t){var r=f[f.length-2],o=n===f.length-2,i=n===f.length-3&&t.added!==r.added;/\n$/.test(t.value)||!o&&!i||e.push("\\ No newline at end of file")}var l=[];e==n&&l.push("Index: "+e),l.push("==================================================================="),l.push("--- "+e+("undefined"==typeof i?"":"	"+i)),l.push("+++ "+n+("undefined"==typeof a?"":"	"+a));var f=g.diff(r,o);f.push({value:"",lines:[]});for(var p=0,d=0,c=[],h=1,v=1,m=0;m<f.length;m++){var y=f[m],b=y.lines||y.value.replace(/\n$/,"").split("\n");if(y.lines=b,y.added||y.removed){if(!p){var k=f[m-1];p=h,d=v,k&&(c=u(k.lines.slice(-4)),p-=c.length,d-=c.length)}c.push.apply(c,t(b,function(e){return(y.added?"+":"-")+e})),s(c,m,y),y.added?v+=b.length:h+=b.length}else{if(p)if(b.length<=8&&m<f.length-2)c.push.apply(c,u(b));else{var w=Math.min(b.length,4);l.push("@@ -"+p+","+(h-p+w)+" +"+d+","+(v-d+w)+" @@"),l.push.apply(l,c),l.push.apply(l,u(b.slice(0,w))),b.length<=4&&s(l,m,y),p=0,d=0,c=[]}h+=b.length,v+=b.length}}return l.join("\n")+"\n"},createPatch:function(e,n,t,r,o){return b.createTwoFilesPatch(e,e,n,t,r,o)},applyPatch:function(e,n){for(var t=n.split("\n"),r=[],o=0,i=!1,a=!1;o<t.length&&!/^@@/.test(t[o]);)o++;for(;o<t.length;o++)if("@"===t[o][0]){var u=t[o].split(/@@ -(\d+),(\d+) \+(\d+),(\d+) @@/);r.unshift({start:u[3],oldlength:+u[2],removed:[],newlength:u[4],added:[]})}else"+"===t[o][0]?r[0].added.push(t[o].substr(1)):"-"===t[o][0]?r[0].removed.push(t[o].substr(1)):" "===t[o][0]?(r[0].added.push(t[o].substr(1)),r[0].removed.push(t[o].substr(1))):"\\"===t[o][0]&&("+"===t[o-1][0]?i=!0:"-"===t[o-1][0]&&(a=!0));var s=e.split("\n");for(o=r.length-1;o>=0;o--){for(var l=r[o],f=0;f<l.oldlength;f++)if(s[l.start-1+f]!==l.removed[f])return!1;Array.prototype.splice.apply(s,[l.start-1,l.oldlength].concat(l.added))}if(i)for(;!s[s.length-1];)s.pop();else a&&s.push("");return s.join("\n")},convertChangesToXML:function(e){for(var n=[],t=0;t<e.length;t++){var r=e[t];r.added?n.push("<ins>"):r.removed&&n.push("<del>"),n.push(i(r.value)),r.added?n.push("</ins>"):r.removed&&n.push("</del>")}return n.join("")},convertChangesToDMP:function(e){for(var n,t,r=[],o=0;o<e.length;o++)n=e[o],t=n.added?1:n.removed?-1:0,r.push([t,n.value]);return r},canonicalize:a};"undefined"!=typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd?define([],function(){return b}):"undefined"==typeof e.JsDiff&&(e.JsDiff=b)}(this);var clickhandlerForm=function(e,n){e.on("click keypress",function(t){var r=$(t.target),o=e.children("input");if(r.is("a")||13==t.which){t.preventDefault();var i=$("<div></div>");i.append(o.val()),n.append(i),updateBrainData(brainData,o.val(),!1);var a=e.serialize();o.val(""),$.ajax({url:"src/php/writeString.php",type:"POST",data:a,dataType:"json",success:function(){}})}})},submitObject=function(e,n){var t={one:e,two:n};updateBrainData(brainData,t.two,t),$.ajax({url:"src/php/writeObject.php",type:"POST",data:t,dataType:"json",success:function(){}})},clickhandlerLog=function(e){var n,t;e.on("click",function(e){var r=$(e.target);!r.is(".editing")&&r.is("div")&&($(".editing").removeClass("editing").removeAttr("contentEditable").html(n),n=r.html(),t="",r.attr("contentEditable",!0).addClass("editing"))}).on("keypress",function(e){var r=$(e.target);r.is(".editing")&&r.is("div")&&13==e.which&&(e.preventDefault(),r.removeClass("editing").removeAttr("contentEditable").blur(),t=r.html().replace("  "," ").trim(),submitObject(n,t,r),n="",t="")})},doSpeak=function(e){{var n=$(e.target);n.val()}speak=$(".hyponet-speak");for(var t=Object.keys(brainData).length,r=0,o=t;o>r;o--)speak.html(brainData[o])},brainData;$(function(){var e=$.getJSON("src/data/brain.json");if(e.fail(function(){console.log("Error fetching brain")}),!$("#hyponet").length){console.log("container not found, auto creating");var n=$('<div id="hyponet"></div>');$("body").prepend(n)}var n=$("#hyponet"),t=$("<link>");t.attr({rel:"stylesheet",href:"src/css/style.css"}),$("head").append(t),e.done(function(){var t=$('<div class="hyponet-log"></div>'),r=$('<div class="hyponet-log-wrapper"></div>');brainData=e.responseJSON;var o=Object.keys(brainData).length,i=0;$.each(brainData,function(e,n){"string"!==$.type(n)?o--:(i++,i>o-10&&t.append("<div>"+n+"</div>"))}),r.append(t),n.append(r),clickhandlerLog(t);{var a=$('<form class="hyponet-form"></form>'),u=$('<input type="text" name="data">');$('<a href="#">send</a>')}a.append(u),n.append(a),clickhandlerForm(a,t);var s=$('<div class="hyponet-speak"></div>');n.append(s),a.keyup($.debounce(doSpeak,300))})});